# Инструменты проверки ударений для русского текста

Набор скриптов для проверки и валидации ударений в русских текстах перед озвучкой через F5-TTS.

## Скрипты

### 1. `extract_all_words_with_stress.py`
**Назначение:** Извлечение всех уникальных слов с ударениями из текста.

**Использование:**
```python
python tools/extract_all_words_with_stress.py
```

**Что делает:**
- Извлекает все слова с ударениями (формат: `сл+ово`)
- Подсчитывает частоту каждого слова
- Создает 3 файла для удобной проверки

**Выходные файлы:**
1. `*_слова_по_частоте_YYYYMMDD_HHMMSS.txt` - слова по частоте (проверяйте топ-500 первыми)
2. `*_слова_алфавит_YYYYMMDD_HHMMSS.txt` - слова по алфавиту с группировкой по буквам
3. `*_список_слов_YYYYMMDD_HHMMSS.txt` - простой список для быстрого поиска

**Когда использовать:**
- После автоматической расстановки ударений (RUAccent)
- Для финальной проверки всех слов в тексте

---

### 2. `comprehensive_stress_check.py`
**Назначение:** Комплексная проверка ударений с поиском ошибок и омонимов.

**Использование:**
```python
python tools/comprehensive_stress_check.py
```

**Что проверяет:**
1. **Слова без ударения (2+ гласных)** - находит многосложные слова без знака ударения
2. **Ошибки в однозначных словах** - сверяет с словарем Зализняка (если доступен)
3. **Потенциальные омонимы** - слова с разными вариантами ударения в тексте

**Выходные файлы:**
1. `карусель_СЛОВА_БЕЗ_УДАРЕНИЯ_YYYYMMDD_HHMMSS.txt`
   - Слова с 2+ гласными без ударения
   - С контекстом (7 слов до и после)
   - Приоритет: исправить в первую очередь

2. `карусель_ОШИБКИ_УДАРЕНИЙ_YYYYMMDD_HHMMSS.txt`
   - Ошибки в однозначных словах
   - Требует словарь Зализняка в `zalizniak-2010/paradigms.txt`

3. `карусель_ОМОНИМЫ_YYYYMMDD_HHMMSS.txt`
   - Слова с несколькими вариантами ударения
   - Показывает все варианты с контекстом
   - Требует ручной проверки правильности

**Когда использовать:**
- После первичной расстановки ударений
- Перед финальной озвучкой
- При подозрении на ошибки в конкретных словах

---

## Формат ударений

В этом проекте используется формат: `+` перед ударной гласной
- ✅ Правильно: `сл+ово`, `т+екст`, `прим+ер`
- ❌ Неправильно: `сло'во`, `текст́`, `при'мер`

## Рабочий процесс проверки

### Шаг 1: Автоматическая расстановка
```bash
# Используйте RUAccent или другой инструмент
python add_stress_marks.py карусель_FINAL.md
```

### Шаг 2: Извлечение всех слов
```bash
python tools/extract_all_words_with_stress.py
```
Проверьте топ-500 самых частых слов - они составляют ~80% текста.

### Шаг 3: Комплексная проверка
```bash
python tools/comprehensive_stress_check.py
```

Проверьте в порядке приоритета:
1. **Омонимы** (135 слов) - ручная проверка по контексту
2. **Слова без ударения** (986 слов) - автоматическое исправление по словарю

### Шаг 4: Исправление
- Омонимы: исправляйте вручную по 3-5 слов за итерацию
- Слова без ударения: используйте словарь Зализняка для автоматической простановки

### Шаг 5: Повторная проверка
Запустите `comprehensive_stress_check.py` снова, чтобы убедиться что количество ошибок уменьшилось.

---

## Статистика (пример из карусель_FINAL.md)

- **Всего слов:** 79,988
- **Уникальных слов:** 14,125
- **Слов без ударения:** 986
- **Омонимов:** 135
- **Средняя частота:** 4.18 раз/слово

## Типичные омонимы в русском языке

| Слово | Варианты | Значения |
|-------|----------|----------|
| замок | з+амок / зам+ок | дверной / крепость |
| атлас | +атлас / атл+ас | ткань / географический |
| мука | м+ука / мук+а | мучение / продукт |
| орган | +орган / орг+ан | инструмент / часть тела |
| уже | уж+е / +уже | нареч. / сравн. степень |

## Требования

- Python 3.8+
- Файл с текстом в формате Markdown
- (Опционально) Словарь Зализняка для проверки однозначных слов

## Словарь Зализняка

Для полной функциональности скачайте словарь:
```
C:\Users\PC\zalizniak-2010\paradigms.txt
```

Если словарь недоступен, проверка однозначных слов будет пропущена, но остальные функции работают.

---

## Часто задаваемые вопросы

**Q: Что делать с омонимами?**
A: Смотрите на контекст и выбирайте правильное ударение. Например:
- "стоял у `зам+ка`" → дверной замок
- "средневековый `з+амок`" → крепость

**Q: Можно ли автоматизировать проверку омонимов?**
A: Частично - через словарь контекстов или ML-модели, но ручная проверка надежнее.

**Q: Сколько времени занимает проверка?**
A:
- Извлечение слов: ~10-30 секунд
- Комплексная проверка: ~1-2 минуты
- Ручная проверка омонимов (135 слов): ~30-60 минут

**Q: Можно ли пропустить проверку омонимов?**
A: Можно, но качество озвучки может пострадать - неправильное ударение меняет смысл.

---

## Авторы и лицензия

Скрипты разработаны для проекта F5-TTS Russian.
Лицензия: MIT
